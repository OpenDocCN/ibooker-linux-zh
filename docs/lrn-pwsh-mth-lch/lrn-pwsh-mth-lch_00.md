# 前言

## 前言

坐下来写这篇前言时，我的第一个想法是，“哇，这里有很多东西要解释。”我自己的 PowerShell 之旅始于 2005 年，大约在 2006 年 TechEd 巴塞罗那大会发布 Shell 之前一年。“在一个月的午餐中学习 Windows PowerShell”，这本书的鼻祖，远非我写的第一本 PowerShell 书籍。我和 Jeff Hicks 首先与 SAPIEN Technologies 合作编写了三版《Windows PowerShell: TFM》。在那之后，我实际上做出了一个决定——如果你能想象的话，就是不再写任何 PowerShell 书籍！但很快我就意识到，当时现有的 PowerShell 书籍选择——那时已经超过十几本——缺少了一个主要受众的需求。那时的书籍都是将 PowerShell 作为一种编程语言来教授，目标是当时相当庞大的 VBScript 编程人员群体。但 PowerShell 本身的目标是面向一个更大、更广泛的受众：非程序员。

那时我开始使用在实时 PowerShell 课程中使用的叙述，并开始构建一本新书：一本不会在第三章就直接进入控制流语句的书，一本会真正专注于最佳教学序列，使学习 PowerShell 尽可能容易。我想做出并保持一个承诺：每天给我一个小时，一个月后，我会让你在 PowerShell 中变得功能实用。

《午餐月》作为一套书系，经历了一段坎坷的道路。图书出版商的利润微薄，而推出一套新书需要消耗大量资源。最初，有另一家出版社决定尝试这个系列，但在最后一刻退缩了。Manning 出版社——我希望这对他们来说是一个出色的决定——站了出来，说：“让我们试试吧。”我们开发了一个新的封面艺术概念，这与公司的常规风格截然不同，展示了他们愿意如何创造性地思考这个新系列。

《在一个月的午餐中学习 Windows PowerShell》是一本成功的书籍，成为世界上最畅销的 PowerShell 书籍之一。它已被翻译成多种不同的语言，对许多人来说，这是他们第一次接触 PowerShell。我收到了成千上万的人的来信，讲述了这本书如何帮助他们进入 PowerShell 世界。对许多人来说，这是他们第一次 PowerShell 学习经历。对大多数人来说，这并不是他们的最后一次，我为这么多人信任我和 Jeff 开始他们的 PowerShell 之旅而感到自豪。

当微软最终将 PowerShell 开源（!!!!!）并且跨平台（!!!!!!!!!）时，我们知道是时候推出一本新的《午餐月》书籍了——一本专注于 PowerShell 而不是仅仅 Windows PowerShell 的书籍。

但到了那时，我和 Jeff 对写作都有些厌倦了。我的职业生涯正在向不同的方向发展——我在公司接受了一个副总裁的角色，我知道我将很难跟上 PowerShell 快速变化和扩展的世界。我的最后一本书，《Shell of an Idea: The Untold History of PowerShell》，在许多方面是对社区和产品团队的一封情书，他们已经支持了十多年，并且一直是朋友。它讲述了 PowerShell 仅仅勉强诞生的故事，当我写作时，我知道我将没有时间再写关于 PowerShell 未来的任何东西了。

正因如此，我很高兴这本书的作者们站了出来。PowerShell 社区普遍充满了极其慷慨的人，总是愿意回答问题并帮助你。“退居二线”，对我来说，也意味着从 PowerShell.org 这个我共同创立的网站和背后的非营利组织退出来。它意味着从 PowerShell + DevOps 全球峰会退出来，这是我最初用美国运通卡资助的会议。但 PowerShell 社区像他们几乎总是做的那样站了出来：新人们同意不仅让组织继续运行，而且还要让它**增长**。这本书的合著者之一 James Petty 就是这些人之一，我永远感激他和他的团队让社区精神保持活力。

这本书在很大程度上是基于我为第一本《午餐月 PowerShell》标题所创作的叙事，以及我和 Jeff Hicks 在三个版本中共同完善的——包括《午餐月 PowerShell 脚本学习》，这本书今天和当初我们写的时候一样相关。但这本书突破了 Windows 操作系统的局限，将 PowerShell 视为一个真正的全球公民：无论你在 Windows、Linux 还是 macOS 上运行 PowerShell，你都会找到适用的例子——这对于这些作者来说是一项巨大的工作，考虑到这些操作系统之间的明显差异。

我对 PowerShell 社区始终怀有无比的感激之情。他们让我感到受欢迎、受尊重和有价值——这是我希望每个人都能在某一点上体验到的。这是一个我鼓励你们去探索的社区，无论是通过 PowerShell.org 还是众多其他由志愿者驱动的网站、GitHub 仓库、Twitter 账户以及其他渠道。你会发现这样做是值得的。

最后，我想让你知道，你在 PowerShell 上的时间投资将带来令人印象深刻的回报。PowerShell 几乎在软件中是独一无二的，它没有寻求重新发明任何东西。相反，它只是想将世界上已经存在的混乱、疯狂、强大的东西变得更为一致和易于使用。例如，PowerShell 尊重 Linux，它没有试图将微软的世界观强加给那个操作系统。相反，PowerShell 只是让 Linux 已经存在的一切变得稍微容易操作一些。

我希望你的 PowerShell 之旅，无论它刚刚开始还是你已经深入其中，都能像我的旅程一样富有成效和令人满意。我希望你能支持这本书的作者，因为他们付出了巨大的努力，将这本书带到你的手中。我还希望你能利用你新获得的知识，找到方法与他人分享，他们可能刚刚开始自己的旅程。无论已经说过或写过的关于 PowerShell 的内容如何，你自己的看法将证明是帮助某人获得“啊哈！”时刻的那个，从而启动他们自己的 PowerShell 成功之旅。

——**唐·琼斯**

## 前言

我从未想过有一天我会被要求帮助编写任何技术书籍，更不用说《一个月午餐学会 PowerShell》第四版了——这本书正是多年前开启我旅程的起点。

当我听说特拉维斯·普伦克和泰勒·莱昂哈特加入了梅宁出版社，将撰写该成功书籍的第四版时，我想：“谁比 PowerShell 团队中的这两个人更适合编写下一版呢？”为了保留早期版本中唐·琼斯和杰弗里·希克斯的获胜风格，泰勒和特拉维斯将基于他们原始的章节进行工作。然而，由于 PowerShell 现在可在 Linux 和 macOS 上使用，因此这本书将专注于这两个操作系统，并展示 PowerShell 7 的开源/跨平台能力。这本书的名称也将改为《一个月午餐学会 PowerShell》，而不是经典书籍第一、第二和第三版的标题《一个月午餐学会 Windows PowerShell》。我很高兴看到这个扩展和更新的版本，我购买了 MEAP，并随着章节的发布而阅读。

快进一年。PowerShell 7 发布了。此外，本书的读者和早期审稿人明确表示，Windows 仍然是大多数管理员花费时间最多的操作系统，因此他们希望第四版包括 Windows 以及 Linux 和 macOS。因此，我被邀请加入团队来完成这本书，并更新它以涵盖最新的 PowerShell 和 Windows 操作系统版本。我继承了 Tyler 和 Travis 的成果，确保三个操作系统都得到了代表。这本书最终确实有点偏重 Windows，这是可以预料的，因为，再次强调，PowerShell 在 Windows 上仍然具有更多的功能。我来自企业环境，每天使用 PowerShell 来支持 Windows 服务器。

对于我来说，从阅读第一本书到帮助编写这一版，这是一段令人惊叹的旅程。无论你是刚开始接触 PowerShell，还是经验丰富的管理员在寻找最新的技巧和窍门，我都希望你喜欢这本书。

——**詹姆斯·佩蒂**

## 致谢

我要向我的妻子 Kacie 表示衷心的感谢，感谢她在整个项目期间的支持。我还要感谢 Don Gannon-Jones 的支持、指导以及鼓励我加入这个项目。对我来说，从阅读 Don 的第一本关于 PowerShell 的《午餐月》到帮助编写这一版，这是一次令人难以置信的完整旅程。

我还要感谢 Manning 出版社的员工：Deirdre Hiam，我的项目编辑；Carrie Andrews，我的校对编辑；Katie Tennant，我的校对员；以及 Shawn Bolan，我的技术校对员。

致所有审稿人：Aldo Solis Zenteno、Birnou Sebarte、Brad Hysmith、Bruce Bergman、Foster Haines、Giuliano Latini、James Matlock、Jan Vinterberg、Jane Noesgaard Larsen、Jean-Sebastien Gervais、Kamesh Ganesan、Marcel van den Brink、Max Almonte、Michel Klomp、Oliver Korten、Paul Love、Peter Brown、Ranjit Sahai、Ray Booysen、Richard Michaels、Roman Levchenko、Shawn Bolan、Simon Seyag、Stefan Turalski、Stephen Goodman、Thein Than Htun 和 Vincent Delcoigne，感谢你们。你们的建议帮助使这本书变得更好。

## 关于本书

我们很高兴你决定加入我们这个为期一个月的旅程！一个月看起来时间很长，但我们保证这将是值得的。

### 适合阅读本书的人群

本书面向广泛的读者群体；然而，主要受众是刚开始接触 PowerShell 的人。工作职能可能包括帮助台或服务器管理员。

你所需的大部分初步信息都在第一章中介绍，但这里有一些我们应该提前说明的事情。首先，我们强烈建议你跟随书中的示例进行操作。为了获得最佳体验，我们建议你在虚拟机上运行所有内容。我们已经尽力确保示例是跨平台的，但正如你将看到的，有几章是针对 Windows 特定的。

其次，准备好从头到尾阅读这本书，按顺序覆盖每一章。再次强调，我们将在第一章中更详细地解释这一点，但理念是每一章都会介绍一些你将在后续章节中需要的新内容。你真的不应该试图一口气读完整本书——坚持每天一章的方法。人类大脑一次只能吸收有限的信息，通过小块小块地学习 PowerShell，你实际上会学得更快、更彻底。

### 关于代码

本书包含大量的代码片段。大多数都很短，你应该能够轻松地输入它们。实际上，我们建议你亲自输入它们，因为这样做将有助于加强一个重要的 PowerShell 技能：准确的输入！较长的代码片段在列表中给出，并且可以从出版社网站上的本书网页下载，网址为[www.manning.com/books/learn-powershell-in-a-month-of-lunches](https://www.manning.com/books/learn-powershell-in-a-month-of-lunches)。

话虽如此，你应该注意一些约定。代码总是以特殊字体显示，就像这个例子一样：

```
Get-CimInstance –class Win32_OperatingSystem 
➥ –computerName SRV-01
```

那个例子也说明了本书中使用的行续字符。它表示这两行应该作为一行在 PowerShell 中输入。换句话说，在输入 `Win32_OperatingSystem` 后不要按 Enter 或 Return 键——继续输入。PowerShell 允许长行，但本书的页面只能容纳这么多。

有时代码也会**`加粗`**以突出显示与章节中先前步骤不同的代码，例如当新功能添加到现有代码行时。有时你也会在文本本身中看到这种代码字体，例如当我们写 `Get-Command` 时。这只是为了让你知道你正在查看一个命令、参数或其他你会在 shell 中输入的元素。

第四，你将看到我们在几个章节中都会提到的元素：反引号字符（`` ` ``）。以下是一个例子：

```
Invoke-Command –scriptblock { Get-ChildItem } `
   -computerName SRV-01,localhost,DC02
```

第一行末尾的字符不是一个多余的墨迹——它是一个真正的字符，你需要输入。在美国键盘上，反引号（或重音符号）通常位于左上角，在 Esc 键下方，与波浪符字符（`~`）在同一键上。当你看到代码列表中的反引号时，要按原样输入。此外，当它在行末出现，如前面的例子所示时，确保它是那一行的最后一个字符。如果你在它之后允许出现任何空格或制表符，反引号将无法正常工作，代码示例也将无法正常工作。

你可以从这本书的 liveBook（在线）版本中获取可执行的代码片段，网址为 [`livebook.manning.com/book/learn-powershell-in-a-month-of-lunches`](https://livebook.manning.com/book/learn-powershell-in-a-month-of-lunches)。书中示例的完整代码可以从 Manning 网站下载，网址为 [www.manning.com/books/learn-powershell-in-a-month-of-lunches](https://www.manning.com/books/learn-powershell-in-a-month-of-lunches)，以及 GitHub 上 [`github.com/psjamesp/Learn-PowerShell-in-a-Month-of-Lunches-4th-Edition`](https://github.com/psjamesp/Learn-PowerShell-in-a-Month-of-Lunches-4th-Edition)。

### liveBook 讨论论坛

购买《Learn PowerShell in a Month of Lunches，第四版》包括对 liveBook 的免费访问，Manning 的在线阅读平台。使用 liveBook 的独家讨论功能，您可以在全球范围内或针对特定章节或段落附加评论。为自己做笔记、提问和回答技术问题，以及从作者和其他用户那里获得帮助都非常简单。要访问论坛，请访问 [`livebook.manning.com/book/learn-powershell-in-a-month-of-lunches/discussion`](https://livebook.manning.com/book/learn-powershell-in-a-month-of-lunches/discussion)。您还可以在 [`livebook.manning.com/discussion`](https://livebook.manning.com/discussion) 了解更多关于 Manning 论坛和行为准则的信息。

Manning 对读者的承诺是提供一个平台，让读者之间以及读者与作者之间可以进行有意义的对话。这并不是对作者参与特定数量活动的承诺，作者对论坛的贡献仍然是自愿的（且未付费）。我们鼓励您向他们提出一些挑战性的问题，以免他们的兴趣偏离！只要书籍在印刷中，论坛和先前讨论的存档将可通过出版社的网站访问。

## 关于作者

James Petty 是 DevOps Collective 的总裁兼首席执行官，该组织运营 PowerShell.org，同时也是微软云和数据中心 MVP。他组织了每年四月举办的 PowerShell + DevOps 全球峰会以及秋季举办的 DevOps + Automation 峰会，并帮助在美国各地举办了多次 PowerShell 周六活动。他是《PowerShell 会议手册》第一卷的撰稿人，也是 Chattanooga PowerShell 用户组的共同创始人，以及田纳西州查塔努加举办的为期两天的 PowerShell 会议“PowerShell on the River”的联合主席。

Travis Plunk 自 2013 年以来一直在多个 PowerShell 团队担任软件工程师，自 1999 年以来在微软工作。他参与了 PowerShell 的开源，并在 PowerShell 成为开源后不久就将核心 PowerShell 引擎迁移了过来。

Tyler Leonhard 在 PowerShell 团队担任软件工程师大约两年，在微软工作了近三年。他是 VS Code 中 PowerShell 扩展的核心维护者，同时也是 PowerShell 团队成员，活跃在社交媒体（Twitter、Twitch 直播、LinkedIn）上。

杰弗里·希克斯是一位拥有 30 年以上经验的 IT 老兵，其中大部分时间都在担任 IT 基础设施顾问，专注于微软服务器技术，强调自动化和效率。他是多年微软 MVP 奖的获得者。如今，他作为一名独立作家、教师和顾问工作。杰夫向全球的 IT 专业人士传授了 PowerShell 和自动化的好处。他撰写并合著了多本书籍，为众多在线网站和印刷出版物撰稿，是 Pluralsight 的作者，并在技术会议和用户组中频繁演讲。您可以在 Twitter 上关注杰夫（[`twitter.com/JeffHicks`](http://twitter.com/JeffHicks)）。您可以在[`jdhitsolutions.com/blog`](https://jdhitsolutions.com/blog)和[`jeffhicks.substack.com`](https://jeffhicks.substack.com)找到他的在线作品。
